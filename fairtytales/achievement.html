<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/simplePagination.js/1.6/jquery.simplePagination.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js"></script>
    <link href="style.css" rel="stylesheet" />
    <title></title>
</head>

<body id="ach_body">
    <nav class="navbar navbar-expand-md navbar-dark" style="background-color: #2a1e2e;">
        <div class="container-fluid">
            <a class="navbar-brand" href="首頁.html">
                <img src="logo1.png" style="height: 30pt;">
            </a>
            <div class="d-flex">
                <div class="collapse navbar-collapse me-2 show" id="navbarNavDarkDropdown">
                    <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                故事選擇
                            </a>
                            <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                                <li><a class="dropdown-item" href="白雪公主主頁.html">白雪公主</a></li>
                                <li><a class="dropdown-item" href="灰姑娘主頁.html">灰姑娘</a></li>
                                <li><a class="dropdown-item" href="小紅帽主頁.html">小紅帽</a></li>
                                <li><a class="dropdown-item" href="青蛙王子主頁.html">青蛙王子</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <a class="navbar-brand" href="player.html">
                    <img src="user.png" style="height: 30pt;">
                </a>
            </div>
        </div>
    </nav>




    <div class="achieve_content">
        <h1>成就</h1>
    </div>


    <div class="achieve_content" id="page1">

        <div class="achieve" id="ach_1">
            <img class="img1" src="medal.png">
            <div class="achieve_title">初來乍到</div>
            <div>完成任意劇情一次</div>
        </div>

        <div class="achieve" id="ach_2">
            <img class="img2" src="medal.png">
            <div class="achieve_title">劇情摸索</div>
            <div>完成任意劇情三次</div>
        </div>

        <div class="achieve" id="ach_3">
            <img class="img3" src="medal.png">
            <div class="achieve_title">駕輕就熟</div>
            <div>完成任意劇情五次</div>
        </div>

        <div class="achieve" id="ach_4">
            <img class="img4" src="medal.png">
            <div class="achieve_title">精通劇情</div>
            <div>完成任意劇情十次</div>
        </div>

        <div class="achieve" id="ach_5">
            <img class="img5" src="medal.png">
            <div class="achieve_title">傳奇探索家</div>
            <div>完成任意劇情十五次</div>
        </div>

    </div>

    <div class="achieve_content" id="page2">

        <div class="achieve" id="ach_6">
            <img class="img6" src="medal.png">
            <div class="achieve_title">探索者</div>
            <div>所有故事都解鎖出任一解局</div>
        </div>

        <div class="achieve" id="ach_7">
            <img class="img7" src="medal.png">
            <div class="achieve_title">故事收藏家</div>
            <div>解鎖任一故事的所有劇情</div>
        </div>

        <div class="achieve" id="ach_8">
            <img class="img8" src="medal.png">
            <div class="achieve_title">探索大師</div>
            <div>解鎖任兩個故事的所有劇情</div>
        </div>

        <div class="achieve" id="ach_9">
            <img class="img9" src="medal.png">
            <div class="achieve_title">全能玩家</div>
            <div>解鎖所有故事的所有劇情</div>
        </div>

        <div class="achieve" id="ach_10">
            <img class="img10" src="medal.png">
            <div class="achieve_title">成就獵人</div>
            <div>解鎖遊戲中的所有成就</div>
        </div>

    </div>

    <!-- <div class="pager">
        <img src="left.png" onclick="pre()" id="pre" title="上一頁">
        <img src="right.png" onclick="next()" id="next" title="下一頁">
    </div> -->

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <li class="page-item"><a class="page-link" onclick="pre()"><img src="left.png" id="pre"
                        title="上一頁"></a></li>
            <li class="page-item"><a class="page-link" onclick="next()"><img src="right.png" id="next"
                        title="下一頁"></a></li>
        </ul>
    </nav>

    <script>

        function pre() {
            document.getElementById('page1').style.display = 'block';
            document.getElementById('page2').style.display = 'none';
        }

        function next() {
            document.getElementById('page1').style.display = 'none';
            document.getElementById('page2').style.display = 'block';
        }



        function getcount() {
            let id = document.cookie.split('=')[0];
            let i1 = document.querySelector('.img1');
            let i2 = document.querySelector('.img2');
            let i3 = document.querySelector('.img3');
            let i4 = document.querySelector('.img4');
            let i5 = document.querySelector('.img5');
            let ach1 = document.getElementById('ach_1');
            let ach2 = document.getElementById('ach_2');
            let ach3 = document.getElementById('ach_3');
            let ach4 = document.getElementById('ach_4');
            let ach5 = document.getElementById('ach_5');
            axios
                .post("http://127.0.0.1:3000/finduser", {
                    帳號: id
                })
                .then((response) => {
                    // console.log(response.data.data[0].次數);
                    // count = count + response.data.data[0].次數;
                    if (response.data.data[0].次數 >= 1) {
                        i1.src = "/public/images/medal1.png";
                        ach1.style.backgroundColor = '#FCF6DB'; 
                        if (response.data.data[0].次數 >= 3) {
                            i2.src = "/public/images/medal1.png";
                            ach2.style.backgroundColor = '#FCF6DB';
                            if (response.data.data[0].次數 >= 5) {
                                i3.src = "/public/images/medal1.png";
                                ach3.style.backgroundColor = '#FCF6DB';
                                if (response.data.data[0].次數 >= 10) {
                                    i4.src = "/public/images/medal1.png";
                                    ach4.style.backgroundColor = '#FCF6DB';
                                    if (response.data.data[0].次數 >= 15) {
                                        i5.src = "/public/images/medal1.png";
                                        ach5.style.backgroundColor = '#FCF6DB';
                                    }
                                }
                            }
                        }
                    }

                })
        }

        function storycollect(){
            let id = document.cookie.split('=')[0];
            let i6 = document.querySelector('.img6');
            let i7 = document.querySelector('.img7');
            let i8 = document.querySelector('.img8');
            let i9 = document.querySelector('.img9');
            let i10 = document.querySelector('.img10');
            let ach6 = document.getElementById('ach_6');
            let ach7 = document.getElementById('ach_7');
            let ach8 = document.getElementById('ach_8');
            let ach9 = document.getElementById('ach_9');
            let ach10 = document.getElementById('ach_10');
            let sEnd = 0;
            let gEnd = 0;
            let rEnd = 0;
            let fEnd = 0;
            axios
                .post("http://127.0.0.1:3000/finduser", {
                    帳號: id
                })
                .then((response) => {
                    response.data.data.forEach((item) => {
                    for(let i = 0; i < item.結局收集.length; i++){
                        // console.log(item.結局收集[i]);
                        if(item.結局收集[i]=='白雪公主,結局一'){
                            sEnd++;
                        }else if(item.結局收集[i]=='白雪公主,結局二'){
                            sEnd++;
                        }else if(item.結局收集[i]=='白雪公主,結局三'){
                            sEnd++;
                        }else if(item.結局收集[i]=='灰姑娘,結局一'){
                            gEnd++;
                        }else if(item.結局收集[i]=='灰姑娘,結局二'){
                            gEnd++;
                        }else if(item.結局收集[i]=='灰姑娘,結局三'){
                            gEnd++;
                        }else if(item.結局收集[i]=='小紅帽,結局一'){
                            rEnd++;
                        }else if(item.結局收集[i]=='小紅帽,結局二'){
                            rEnd++;
                        }else if(item.結局收集[i]=='小紅帽,結局三'){
                            rEnd++; 
                        }else if(item.結局收集[i]=='青蛙王子,結局一'){
                            fEnd++;
                        }else if(item.結局收集[i]=='青蛙王子,結局二'){
                            fEnd++;
                        }
                    }                    
                })

                let Endnum = 0;
                if(sEnd == 3){
                    Endnum++;
                }
                if(gEnd == 3){
                    Endnum++;
                }
                if(rEnd == 3){
                    Endnum++;
                }
                if(fEnd == 2){
                    Endnum++;
                }
                 
                if(sEnd >= 1 && gEnd >= 1 && rEnd >= 1 && fEnd >= 1 ){
                    i6.src = "/public/images/medal1.png";
                    ach6.style.backgroundColor = '#FCF6DB';
                }
                if(sEnd == 3 || gEnd == 3 || rEnd == 3 || fEnd == 2 ){
                    i7.src = "/public/images/medal1.png";
                    ach7.style.backgroundColor = '#FCF6DB';
                }
                
                if(Endnum >= 2){
                    i8.src = "/public/images/medal1.png";
                    ach8.style.backgroundColor = '#FCF6DB';
                }

                if(sEnd == 3 && gEnd == 3 && rEnd == 3 && fEnd == 2 ){
                    i9.src = "/public/images/medal1.png";
                    ach9.style.backgroundColor = '#FCF6DB';
                }
                if ((response.data.data[0].次數 >= 15)&&(sEnd == 3 && gEnd == 3 && rEnd == 3 && fEnd == 2 )) {
                    i10.src = "/public/images/medal1.png";
                    ach10.style.backgroundColor = '#FCF6DB';
                }

                })
        }
        
        

        getcount();
        storycollect();
        console.log(count);

    </script>

</body>

</html>
